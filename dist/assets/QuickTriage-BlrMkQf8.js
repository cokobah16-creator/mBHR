import{u as A,d as P,e as $,r as d,j as e,g as v,l as O,k as R,n as f,f as B}from"./index-Cg81Mk6P.js";function E({patientId:p,onComplete:m,onCancel:g}){const{t:u}=A(),{currentUser:x}=P();$();const[a,j]=d.useState(null),[o,y]=d.useState(""),[c,N]=d.useState({airway:"clear",breathing:"normal",circulation:"normal"}),[r,n]=d.useState({conscious:!0,responsive:!0,skinColor:"normal",temperature:"normal"}),[b,h]=d.useState(!1),w=[{value:"urgent",label:u("triage.priority.urgent"),description:"Immediate attention required",color:"bg-red-500 hover:bg-red-600 text-white",icon:"🚨",examples:["Chest pain","Difficulty breathing","Unconscious","Severe bleeding"]},{value:"normal",label:u("triage.priority.normal"),description:"Standard care pathway",color:"bg-yellow-500 hover:bg-yellow-600 text-white",icon:"⚠️",examples:["Fever","Cough","Minor injuries","Routine check-up"]},{value:"low",label:u("triage.priority.low"),description:"Can wait for routine care",color:"bg-green-500 hover:bg-green-600 text-white",icon:"✅",examples:["Minor cuts","Prescription refills","Health education"]}],k={airway:[{value:"clear",label:"Clear",safe:!0},{value:"partial",label:"Partially obstructed",safe:!1},{value:"obstructed",label:"Obstructed",safe:!1}],breathing:[{value:"normal",label:"Normal",safe:!0},{value:"labored",label:"Labored",safe:!1},{value:"absent",label:"Absent/Minimal",safe:!1}],circulation:[{value:"normal",label:"Normal pulse",safe:!0},{value:"weak",label:"Weak pulse",safe:!1},{value:"absent",label:"No pulse",safe:!1}]},i=(()=>{if(c.airway!=="clear"||c.breathing!=="normal"||c.circulation!=="normal"||!r.conscious||!r.responsive)return"urgent";if(r.temperature==="high")return"normal";if(r.skinColor!=="normal")return"urgent";const s=["chest pain","difficulty breathing","severe pain","bleeding","unconscious"],l=o.toLowerCase();return s.some(t=>l.includes(t))?"urgent":"normal"})(),C=async()=>{if(!(!a||!x)){h(!0);try{const s={id:f(),patientId:p||"walk-in",assessedBy:x.id,priority:a,chiefComplaint:o,abcAssessment:JSON.stringify(c),vitalSigns:JSON.stringify(r),suggestedPriority:i,overriddenPriority:a!==i,createdAt:new Date,_dirty:1};await B.triageSamples.add({id:f(),createdAt:new Date,caseHash:btoa(JSON.stringify({chiefComplaint:o,abcAssessment:c,vitalSigns:r})),goldPriority:a,createdBy:x.id});let l="vitals";a==="urgent"&&(l="consult"),m==null||m(a,l)}catch(s){console.error("Error saving triage assessment:",s),alert("Failed to save triage assessment")}finally{h(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Quick Triage Assessment"}),e.jsx("p",{className:"text-gray-600",children:"Rapid priority assessment for patient flow"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Chief Complaint"}),e.jsx("textarea",{value:o,onChange:s=>y(s.target.value),className:"input-field",rows:3,placeholder:"What is the main problem? (e.g., chest pain, fever, cough)"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ABC Assessment"}),e.jsx("div",{className:"space-y-4",children:Object.entries(k).map(([s,l])=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 capitalize",children:s}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:l.map(t=>e.jsx("button",{onClick:()=>N(S=>({...S,[s]:t.value})),className:`p-3 rounded-lg border text-left transition-all ${c[s]===t.value?t.safe?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-800":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.safe?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"font-medium",children:t.label})]})},t.value))})]},s))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Vital Assessment"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Conscious"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>n(s=>({...s,conscious:!0})),className:`flex-1 p-2 rounded-lg border ${r.conscious?"border-green-300 bg-green-50 text-green-800":"border-gray-200"}`,children:"Yes"}),e.jsx("button",{onClick:()=>n(s=>({...s,conscious:!1})),className:`flex-1 p-2 rounded-lg border ${r.conscious?"border-gray-200":"border-red-300 bg-red-50 text-red-800"}`,children:"No"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsive"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>n(s=>({...s,responsive:!0})),className:`flex-1 p-2 rounded-lg border ${r.responsive?"border-green-300 bg-green-50 text-green-800":"border-gray-200"}`,children:"Yes"}),e.jsx("button",{onClick:()=>n(s=>({...s,responsive:!1})),className:`flex-1 p-2 rounded-lg border ${r.responsive?"border-gray-200":"border-red-300 bg-red-50 text-red-800"}`,children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skin Color"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"normal",label:"Normal",safe:!0},{value:"pale",label:"Pale",safe:!1},{value:"cyanotic",label:"Blue/Gray",safe:!1}].map(s=>e.jsx("button",{onClick:()=>n(l=>({...l,skinColor:s.value})),className:`p-2 rounded-lg border text-center ${r.skinColor===s.value?s.safe?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-800":"border-gray-200 hover:border-gray-300"}`,children:s.label},s.value))})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card bg-blue-50 border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(O,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-medium text-blue-800",children:"AI Suggestion"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:i==="urgent"?"🚨":i==="normal"?"⚠️":"✅"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-blue-800 capitalize",children:[i," Priority"]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Based on ABC assessment and symptoms"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assign Priority"}),e.jsx("div",{className:"space-y-4",children:w.map(s=>e.jsx("button",{onClick:()=>j(s.value),className:`w-full p-4 rounded-xl border-2 transition-all touch-target-large ${a===s.value?`${s.color} ring-2 ring-primary/20`:"bg-white border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-3xl",children:s.icon}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:"text-lg font-bold",children:s.label}),e.jsx("div",{className:"text-sm opacity-90",children:s.description}),e.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["Examples: ",s.examples.slice(0,2).join(", ")]})]}),a===s.value&&e.jsx(R,{className:"h-6 w-6"})]})},s.value))})]}),a&&a!==i&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Priority Override"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["You selected ",a," but AI suggests ",i,". Please confirm your clinical judgment."]})]})]})}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:C,disabled:!a||b,className:"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Saving...":"Complete Triage"}),g&&e.jsx("button",{onClick:g,className:"btn-secondary",children:"Cancel"})]})]})]})]})}export{E as default};
